<div id="guestBill" ng-cloak>
  <button ng-click="guestBill.goToAllDishes()" class="allDishes">See All Dishes</button>
  <button ng-show="guestBill.isHost" ng-click="guestBill.goToHostBill()" class="hostBill">See Final Bill</button>
  <h1>{{ _.capitalize(guestBill.username) }}'s Total Bill</h1>


  <!-- <div ng-repeat="dish in guestBill.data.dishes"> -->
  <div ng-repeat="dish in guestBill.getGuestDishes(guestBill.user_id, guestBill.data.dishes)">
    <h2>{{_.capitalize(dish.name)}}</h2>
    <p>Your portion: {{ guestBill.getDishIndivCost(guestBill.user_id, dish) | currency }}</p>
    <small>Total Cost</small>
    <span><small>{{ dish.cost | currency }}</small></span>
    <h3>You Shared This With:</h3>

    <p ng-repeat="person in guestBill.data.users">
      <span ng-if="guestBill.isDishSharedWithThisOtherUser(person.id, dish) && person.id !== guestBill.user_id">
        <span>{{ _.capitalize(person.username) }}</span>
      </span>
    </p>
    <!-- or -->
    <!-- <p ng-show="guestBill.isDishShared(guestBill.user_id, dish)" ng-repeat="person in guestBill.getOtherSharedUserForDish(guestBill.user_id, dish, guestBill.data.users) ">
      <span>{{ _.capitalize(person.username) }}</span>
    </p> -->
    <p ng-if="!guestBill.isDishShared(guestBill.user_id, dish)">
      <span>Shared by yourself only</span>
    </p>
  </div>

  <br>

  <h1>Your Subtotal</h1>
  <h2>{{guestBill.getGuestTotal(guestBill.data) | currency}}</h2>

  <div ng-if="!guestBill.billSent && !guestBill.isHost">
    Your host hasn't decided on the tip and tax yet. Please check again later.
  </div>

  <div ng-if="guestBill.billSent">
    <h3>Tax</h3>
    <p>{{guestBill.guestTax | currency}}</p>
    <small>You were charged {{ guestBill.billData.taxPercent }}% for tax.</small>
    <h3>Tip</h3>
    <p>{{guestBill.guestTip | currency}}</p>
    <small>Your host chose {{ guestBill.billData.tipPercent }}% for tip.</small>
    <h2>Your Total</h2>
    <p>{{guestBill.guestGrandTotal | currency}}</p>
    <small>(Dinner Grand Total: {{  guestBill.billData.grandTotal | currency}})</small>
  </div>
  <br><br>
</div>
